import{_ as B}from"./WithGithub.ce8f6c86.js";import{v as F,J as N,w as R,Q as u,T as S,S as A,x as i,q as D,r as G,s as p,y as s,C as t,A as o,z as _,D as h,G as U}from"./vendor.a61334ed.js";import{$ as L,l as M,u as P}from"./app.3dee77a8.js";import{v as T}from"./validate.a60ae09d.js";import{u as $}from"./app.90aab714.js";import"./plugin-vue_export-helper.21dcd24c.js";const j={class:"max-w-300px m-auto"},z={class:"login-container"},I={class:"title-container"},J={text:"2xl",p:"10"},Q={class:"flex justify-between"},le=F({setup(W){const x=N(),{t:r}=R(),y=$(),c=u(!1),l=S({serverUrl:y.serverUrl,email:"",password:""}),f=u(),v=u(),g=u(),V=u(!0),b={email:[{required:!0,trigger:"blur",validator:(d,e,a)=>{T()?a():a(new Error(r("error.username")))}}],password:[{required:!0,trigger:"blur",validator:(d,e,a)=>{e.length<6?a(new Error(r("error.password"))):a()}}]};A(()=>{l.email===""?v.value.focus():l.password===""&&g.value.focus()});function E(){f.value.validate(async d=>{if(d){L.defaults.baseURL=l.serverUrl,c.value=!0;try{const e=await M({email:l.email,password:l.password},V.value);e&&e.data&&e.data.token?(P.value=e.data.url,x.push("/dashboard"),U.success({message:r("message.login_success"),showClose:!0})):U.success({message:e.errmsg,showClose:!0})}catch{}c.value=!1}})}return(d,e)=>{const a=i("el-input"),m=i("el-form-item"),w=i("el-button"),k=i("el-form"),C=i("router-link"),q=B;return D(),G("main",j,[p("div",z,[s(k,{ref_key:"loginFormEl",ref:f,model:o(l),rules:b,"status-icon":"",autocomplete:"on","label-position":"left"},{default:t(()=>[p("div",I,[p("h2",J,_(o(r)("login.title")),1)]),s(m,{prop:"serverUrl",required:""},{default:t(()=>[s(a,{ref:"serverUrlEl",modelValue:o(l).serverUrl,"onUpdate:modelValue":e[0]||(e[0]=n=>o(l).serverUrl=n),placeholder:o(r)("placeholder.server_url"),name:"serverUrl",type:"text",autocomplete:"on"},null,8,["modelValue","placeholder"])]),_:1}),s(m,{prop:"email"},{default:t(()=>[s(a,{ref_key:"emailEl",ref:v,modelValue:o(l).email,"onUpdate:modelValue":e[1]||(e[1]=n=>o(l).email=n),placeholder:o(r)("placeholder.email"),name:"email",type:"text",autocomplete:"on"},null,8,["modelValue","placeholder"])]),_:1}),s(m,{prop:"password"},{default:t(()=>[s(a,{ref_key:"passwordEl",ref:g,modelValue:o(l).password,"onUpdate:modelValue":e[2]||(e[2]=n=>o(l).password=n),placeholder:o(r)("placeholder.password"),name:"password",type:"password",autocomplete:"on"},null,8,["modelValue","placeholder"])]),_:1}),s(m,null,{default:t(()=>[s(w,{type:"primary",class:"block w-full",loading:c.value,onClick:E},{default:t(()=>[h(_(o(r)("button.login")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),p("div",Q,[s(C,{to:"/register"},{default:t(()=>[s(w,null,{default:t(()=>[h(_(o(r)("button.register")),1)]),_:1})]),_:1}),s(q)])])])}}});export{le as default};
